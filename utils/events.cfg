#define EOMA_GLOBAL_EVENTS
    [event]
        name=post summon
        first_time_only=no

        [store_unit]
            [filter]
                id=$second_unit.id
            [/filter]
            variable=summoner
        [/store_unit]

        [store_unit]
            [filter]
                id=$second_unit.id
                ability=eoma_fastsummon
            [/filter]
            variable=fast_summoners
        [/store_unit]

        {VARIABLE summoner.attacks_left 0}
        {IF_VAR fast_summoners.length equals 0 (
            [then]
                {VARIABLE summoner.moves 0}
            [/then]
            [else]
                {VARIABLE_OP summoner.moves sub 1}
            [/else]
        )}
        {VARIABLE_OP summoner.experience add 3}

        [unstore_unit]
            variable=summoner
            find_vacant=no
            text= _ "+3 exp"
            red,green,blue=50,50,200
        [/unstore_unit]

        {CLEAR_VARIABLE summoner}
        {CLEAR_VARIABLE fast_summoners}
    [/event]
#enddef
